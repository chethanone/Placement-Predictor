{% extends 'predictor/base.html' %}
{% load static %}

{% block title %}{{ student.user.get_full_name }} - Student Detail{% endblock %}

{% block content %}
<div class="student-detail-container">
 <div class="container">
 <div class="page-header">
 <a href="{% url 'teacher_all_students' %}" class="back-btn">
 <i class="fas fa-arrow-left"></i> Back to Students
 </a>
 <h1>Student Details</h1>
 </div>

 <!-- Student Profile Card -->
 <div class="profile-card">
 <div class="profile-header">
 <div class="avatar">
 <i class="fas fa-user-graduate"></i>
 </div>
 <div class="profile-info">
 <h2>{{ student.user.get_full_name }}</h2>
 <p class="meta">
 <span><i class="fas fa-id-card"></i> {{ student.roll_number }}</span>
 <span><i class="fas fa-envelope"></i> {{ student.email }}</span>
 <span><i class="fas fa-book"></i> {{ student.stream }}</span>
 <span><i class="fas fa-calendar"></i> Year {{ student.year }}</span>
 </p>
 </div>
 <div class="profile-actions">
 <a href="{% url 'teacher_verify_student' student.id %}" class="btn-primary">
 <i class="fas fa-edit"></i> Edit Scores
 </a>
 </div>
 </div>
 </div>

 <!-- Skill Scores Card -->
 <div class="info-card">
 <h3><i class="fas fa-chart-bar"></i> Skill Scores</h3>
 {% if skill_scores %}
 <div class="skills-grid">
 <div class="skill-item">
 <label>CGPA</label>
 <div class="progress-bar">
 <div class="progress-fill" style="width: {{ skill_scores.cgpa|multiply:10 }}%"></div>
 <span class="progress-text">{{ skill_scores.cgpa }}/10</span>
 </div>
 </div>
 <div class="skill-item">
 <label>Previous Semester</label>
 <div class="progress-bar">
 <div class="progress-fill" style="width: {{ skill_scores.previous_semester }}%"></div>
 <span class="progress-text">{{ skill_scores.previous_semester }}%</span>
 </div>
 </div>
 <div class="skill-item">
 <label>Technical Skills</label>
 <div class="progress-bar">
 <div class="progress-fill" style="width: {{ skill_scores.technical_skills|multiply:10 }}%"></div>
 <span class="progress-text">{{ skill_scores.technical_skills }}/10</span>
 </div>
 </div>
 <div class="skill-item">
 <label>Programming Skills</label>
 <div class="progress-bar">
 <div class="progress-fill" style="width: {{ skill_scores.programming_skills|multiply:10 }}%"></div>
 <span class="progress-text">{{ skill_scores.programming_skills }}/10</span>
 </div>
 </div>
 <div class="skill-item">
 <label>Communication Skills</label>
 <div class="progress-bar">
 <div class="progress-fill" style="width: {{ skill_scores.communication_skills|multiply:10 }}%"></div>
 <span class="progress-text">{{ skill_scores.communication_skills }}/10</span>
 </div>
 </div>
 <div class="skill-item">
 <label>Soft Skills</label>
 <div class="progress-bar">
 <div class="progress-fill" style="width: {{ skill_scores.soft_skills|multiply:10 }}%"></div>
 <span class="progress-text">{{ skill_scores.soft_skills }}/10</span>
 </div>
 </div>
 <div class="skill-item">
 <label>Aptitude Score</label>
 <div class="progress-bar">
 <div class="progress-fill" style="width: {{ skill_scores.aptitude_score }}%"></div>
 <span class="progress-text">{{ skill_scores.aptitude_score }}/100</span>
 </div>
 </div>
 </div>
 
 <div class="additional-info">
 <div class="info-row">
 <span class="label">Projects Completed:</span>
 <span class="value">{{ skill_scores.projects_completed }}</span>
 </div>
 <div class="info-row">
 <span class="label">Internships:</span>
 <span class="value">{{ skill_scores.internships }}</span>
 </div>
 <div class="info-row">
 <span class="label">Certifications:</span>
 <span class="value">{{ skill_scores.certifications }}</span>
 </div>
 <div class="info-row">
 <span class="label">Extracurricular Activities:</span>
 <span class="value">{{ skill_scores.extracurricular_activities }}</span>
 </div>
 <div class="info-row">
 <span class="label">Backlogs:</span>
 <span class="value">{{ skill_scores.backlogs }}</span>
 </div>
 <div class="info-row">
 <span class="label">College Tier:</span>
 <span class="value">Tier {{ skill_scores.college_tier }}</span>
 </div>
 </div>
 
 {% if skill_scores.is_verified %}
 <div class="verification-status verified">
 <i class="fas fa-check-circle"></i>
 Verified by {{ skill_scores.verified_by.user.get_full_name }} on {{ skill_scores.verified_at|date:"M d, Y" }}
 </div>
 {% else %}
 <div class="verification-status pending">
 <i class="fas fa-clock"></i>
 Not yet verified
 </div>
 {% endif %}
 {% else %}
 <div class="no-data">
 <i class="fas fa-exclamation-circle"></i>
 <p>No skill scores recorded yet</p>
 <a href="{% url 'teacher_verify_student' student.id %}" class="btn-primary">
 Add Scores
 </a>
 </div>
 {% endif %}
 </div>

 <!-- Quiz History -->
 <div class="info-card">
 <h3><i class="fas fa-file-alt"></i> Quiz History</h3>
 {% if quizzes %}
 <div class="quiz-list">
 {% for quiz in quizzes %}
 <div class="quiz-item">
 <div class="quiz-info">
 <h4>Quiz - {{ quiz.created_at|date:"M d, Y" }}</h4>
 <p>Status: <span class="status-{{ quiz.status }}">{{ quiz.get_status_display }}</span></p>
 </div>
 <div class="quiz-score">
 {% if quiz.score %}
 <span class="score">{{ quiz.score|floatformat:1 }}%</span>
 {% else %}
 <span class="score">-</span>
 {% endif %}
 </div>
 </div>
 {% endfor %}
 </div>
 {% else %}
 <div class="no-data-small">
 <i class="fas fa-inbox"></i>
 <p>No quiz submissions yet</p>
 </div>
 {% endif %}
 </div>

 <!-- Verification History -->
 <div class="info-card">
 <h3><i class="fas fa-history"></i> Verification History</h3>
 {% if verifications %}
 <div class="verification-list">
 {% for verification in verifications %}
 <div class="verification-item">
 <div class="verification-header">
 <span class="date">{{ verification.created_at|date:"M d, Y H:i" }}</span>
 <span class="status {% if verification.is_approved %}approved{% else %}pending{% endif %}">
 {% if verification.is_approved %}
 <i class="fas fa-check"></i> Approved
 {% else %}
 <i class="fas fa-clock"></i> Pending
 {% endif %}
 </span>
 </div>
 {% if verification.notes %}
 <div class="verification-notes">
 {{ verification.notes }}
 </div>
 {% endif %}
 </div>
 {% endfor %}
 </div>
 {% else %}
 <div class="no-data-small">
 <i class="fas fa-inbox"></i>
 <p>No verification history</p>
 </div>
 {% endif %}
 </div>
 </div>
</div>

<style>
.student-detail-container {
 padding: 30px 0;
 min-height: 100vh;
 background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
}

.page-header {
 margin-bottom: 30px;
}

.back-btn {
 display: inline-flex;
 align-items: center;
 gap: 8px;
 padding: 10px 20px;
 background: white;
 color: #667eea;
 text-decoration: none;
 border-radius: 8px;
 margin-bottom: 15px;
 font-weight: 600;
 box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.back-btn:hover {
 background: #667eea;
 color: white;
}

.profile-card {
 background: white;
 border-radius: 15px;
 box-shadow: 0 5px 20px rgba(0,0,0,0.1);
 margin-bottom: 30px;
 overflow: hidden;
}

.profile-header {
 background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
 padding: 30px;
 display: flex;
 align-items: center;
 gap: 25px;
 color: white;
}

.avatar {
 width: 100px;
 height: 100px;
 background: rgba(255,255,255,0.2);
 border-radius: 50%;
 display: flex;
 align-items: center;
 justify-content: center;
 font-size: 3rem;
}

.profile-info {
 flex: 1;
}

.profile-info h2 {
 margin: 0 0 15px 0;
 font-size: 2rem;
}

.profile-info .meta {
 display: flex;
 gap: 20px;
 flex-wrap: wrap;
}

.profile-info .meta span {
 display: flex;
 align-items: center;
 gap: 8px;
}

.profile-actions .btn-primary {
 padding: 12px 25px;
 background: white;
 color: #667eea;
 text-decoration: none;
 border-radius: 8px;
 display: inline-flex;
 align-items: center;
 gap: 10px;
 font-weight: 600;
}

.info-card {
 background: white;
 border-radius: 15px;
 box-shadow: 0 5px 15px rgba(0,0,0,0.1);
 padding: 30px;
 margin-bottom: 30px;
}

.info-card h3 {
 color: #667eea;
 margin-bottom: 25px;
 display: flex;
 align-items: center;
 gap: 10px;
}

.skills-grid {
 display: grid;
 gap: 20px;
 margin-bottom: 30px;
}

.skill-item label {
 display: block;
 font-weight: 600;
 color: #333;
 margin-bottom: 8px;
}

.progress-bar {
 position: relative;
 height: 30px;
 background: #f0f0f0;
 border-radius: 15px;
 overflow: hidden;
}

.progress-fill {
 height: 100%;
 background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
 transition: width 0.3s;
}

.progress-text {
 position: absolute;
 top: 50%;
 left: 50%;
 transform: translate(-50%, -50%);
 font-weight: bold;
 color: #333;
}

.additional-info {
 display: grid;
 grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
 gap: 15px;
 padding: 20px;
 background: #f8f9fa;
 border-radius: 10px;
 margin-bottom: 20px;
}

.info-row {
 display: flex;
 justify-content: space-between;
}

.info-row .label {
 font-weight: 600;
 color: #666;
}

.info-row .value {
 color: #333;
 font-weight: bold;
}

.verification-status {
 padding: 15px;
 border-radius: 8px;
 display: flex;
 align-items: center;
 gap: 10px;
 font-weight: 600;
}

.verification-status.verified {
 background: #d4edda;
 color: #155724;
}

.verification-status.pending {
 background: #fff3cd;
 color: #856404;
}

.no-data, .no-data-small {
 text-align: center;
 padding: 40px 20px;
 color: #999;
}

.no-data i, .no-data-small i {
 font-size: 2.5rem;
 margin-bottom: 15px;
 display: block;
}
</style>

{% load custom_filters %}
{% endblock %}
