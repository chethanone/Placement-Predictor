{% extends 'predictor/base.html' %}
{% load static %}

{% block title %}Prediction Results - AI Placement Predictor{% endblock %}

{% block content %}
<div class="container">
 <div class="result-card">
 <!-- Header -->
 <div class="result-header">
 <h1 class="result-title">
 <i class="fas fa-chart-line"></i>
 Placement Prediction Results
 </h1>
 <p class="student-name">for <strong>{{ name }}</strong></p>
 </div>

 <!-- Prediction Gauge -->
 <div class="prediction-gauge">
 <div class="gauge-container">
 <div class="circular-progress" data-percentage="{{ probability|floatformat:0 }}">
 <div class="circular-progress-inner">
 <div class="circular-progress-percentage">
 {{ probability|floatformat:1 }}%
 </div>
 <div class="circular-progress-label">
 Placement Chance
 </div>
 </div>
 </div>
 </div>
 
 <div class="prediction-status {% if probability >= 70 %}status-high{% elif probability >= 40 %}status-medium{% else %}status-low{% endif %}">
 <h2>
 {% if probability >= 70 %}
 <i class="fas fa-check-circle"></i> High Chances
 {% elif probability >= 40 %}
 <i class="fas fa-exclamation-circle"></i> Moderate Chances
 {% else %}
 <i class="fas fa-times-circle"></i> Needs Improvement
 {% endif %}
 </h2>
 <p class="prediction-text">
 {% if probability >= 70 %}
 Excellent profile! You have strong placement chances. Focus on premium companies.
 {% elif probability >= 40 %}
 Good foundation, but there's room for improvement. Follow the recommendations below.
 {% else %}
 Your profile needs significant improvement. Focus on the critical recommendations.
 {% endif %}
 </p>
 </div>
 </div>

 <!-- Key Metrics -->
 <div class="metrics-grid">
 <div class="metric-card">
 <div class="metric-icon"></div>
 <div class="metric-value">{{ features.CGPA|floatformat:2 }}</div>
 <div class="metric-label">CGPA</div>
 </div>
 <div class="metric-card">
 <div class="metric-icon"></div>
 <div class="metric-value">{{ features.Internships }}</div>
 <div class="metric-label">Internships</div>
 </div>
 <div class="metric-card">
 <div class="metric-icon"></div>
 <div class="metric-value">{{ features.Technical_Skills|floatformat:1 }}</div>
 <div class="metric-label">Technical Skills</div>
 </div>
 <div class="metric-card">
 <div class="metric-icon"></div>
 <div class="metric-value">{{ features.Programming_Skills|floatformat:1 }}</div>
 <div class="metric-label">Programming</div>
 </div>
 <div class="metric-card">
 <div class="metric-icon"></div>
 <div class="metric-value">{{ features.Projects_Completed }}</div>
 <div class="metric-label">Projects</div>
 </div>
 <div class="metric-card">
 <div class="metric-icon"></div>
 <div class="metric-value">{{ features.Certifications }}</div>
 <div class="metric-label">Certifications</div>
 </div>
 </div>

 <!-- Recommendations -->
 <div class="recommendations-section">
 <h2 class="section-title">
 <i class="fas fa-lightbulb"></i>
 Personalized Recommendations
 </h2>
 
 {% if recommendations %}
 <div class="recommendations-list">
 {% for rec in recommendations %}
 <div class="recommendation-card priority-{{ rec.priority|lower }}">
 <div class="rec-header">
 <span class="rec-priority badge-{{ rec.priority|lower }}">
 {% if rec.priority == 'Critical' %}
 <i class="fas fa-exclamation-triangle"></i>
 {% elif rec.priority == 'High' %}
 <i class="fas fa-arrow-up"></i>
 {% else %}
 <i class="fas fa-info-circle"></i>
 {% endif %}
 {{ rec.priority }}
 </span>
 <span class="rec-impact">{{ rec.impact }}</span>
 </div>
 <h3 class="rec-title">{{ rec.title }}</h3>
 <p class="rec-description">{{ rec.description }}</p>
 </div>
 {% endfor %}
 </div>
 {% else %}
 <div class="no-recommendations">
 <i class="fas fa-star"></i>
 <p>Great job! Your profile is strong across all areas.</p>
 </div>
 {% endif %}
 </div>

 <!-- Top Features -->
 <div class="features-section">
 <h2 class="section-title">
 <i class="fas fa-ranking-star"></i>
 Top 10 Important Features
 </h2>
 <div class="features-list">
 {% for feat in feature_importance %}
 <div class="feature-item">
 <div class="feature-name">{{ feat.feature }}</div>
 <div class="feature-bar-container">
 <div class="feature-bar" style="width: {{ feat.importance_percentage }}%"></div>
 </div>
 <div class="feature-value">{{ feat.importance_percentage|floatformat:1 }}%</div>
 </div>
 {% endfor %}
 </div>
 </div>

 <!-- Actions -->
 <div class="action-buttons">
 <a href="{% url 'home' %}" class="btn btn-primary">
 <i class="fas fa-redo"></i> Try Another Prediction
 </a>
 <a href="{% url 'dashboard' %}" class="btn btn-secondary">
 <i class="fas fa-chart-bar"></i> View Dashboard
 </a>
 </div>
 </div>
</div>

<style>
.result-card {
 background: white;
 border-radius: 20px;
 padding: 40px;
 box-shadow: 0 10px 40px rgba(0,0,0,0.1);
 margin: 30px auto;
 max-width: 1000px;
}

.result-header {
 text-align: center;
 margin-bottom: 40px;
}

.result-title {
 font-size: 2.5rem;
 color: #667eea;
 margin-bottom: 10px;
}

.student-name {
 font-size: 1.2rem;
 color: #666;
}

.prediction-gauge {
 display: grid;
 grid-template-columns: 1fr 1fr;
 gap: 40px;
 margin-bottom: 40px;
 align-items: center;
}

.gauge-container {
 display: flex;
 justify-content: center;
}

.circular-progress {
 width: 250px;
 height: 250px;
 border-radius: 50%;
 background: conic-gradient(
 #667eea 0% calc(var(--percentage) * 1%),
 #e0e7ff calc(var(--percentage) * 1%) 100%
 );
 display: flex;
 align-items: center;
 justify-content: center;
 position: relative;
}

.circular-progress-inner {
 width: 200px;
 height: 200px;
 border-radius: 50%;
 background: white;
 display: flex;
 flex-direction: column;
 align-items: center;
 justify-content: center;
}

.circular-progress-percentage {
 font-size: 3rem;
 font-weight: bold;
 color: #667eea;
}

.circular-progress-label {
 font-size: 1rem;
 color: #666;
}

.prediction-status {
 padding: 30px;
 border-radius: 15px;
 text-align: center;
}

.status-high {
 background: linear-gradient(135deg, #10b981, #059669);
 color: white;
}

.status-medium {
 background: linear-gradient(135deg, #f59e0b, #d97706);
 color: white;
}

.status-low {
 background: linear-gradient(135deg, #ef4444, #dc2626);
 color: white;
}

.prediction-status h2 {
 margin-bottom: 15px;
 font-size: 1.8rem;
}

.metrics-grid {
 display: grid;
 grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
 gap: 20px;
 margin-bottom: 40px;
}

.metric-card {
 background: linear-gradient(135deg, #667eea, #764ba2);
 color: white;
 padding: 20px;
 border-radius: 15px;
 text-align: center;
}

.metric-icon {
 font-size: 2rem;
 margin-bottom: 10px;
}

.metric-value {
 font-size: 2rem;
 font-weight: bold;
 margin-bottom: 5px;
}

.metric-label {
 font-size: 0.9rem;
 opacity: 0.9;
}

.recommendations-section,
.features-section {
 margin-bottom: 40px;
}

.section-title {
 font-size: 1.8rem;
 color: #333;
 margin-bottom: 25px;
 display: flex;
 align-items: center;
 gap: 10px;
}

.recommendations-list {
 display: flex;
 flex-direction: column;
 gap: 20px;
}

.recommendation-card {
 background: white;
 border-left: 5px solid;
 padding: 20px;
 border-radius: 10px;
 box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.priority-critical {
 border-color: #ef4444;
 background: #fef2f2;
}

.priority-high {
 border-color: #f59e0b;
 background: #fffbeb;
}

.priority-medium {
 border-color: #3b82f6;
 background: #eff6ff;
}

.priority-low {
 border-color: #10b981;
 background: #f0fdf4;
}

.rec-header {
 display: flex;
 justify-content: space-between;
 align-items: center;
 margin-bottom: 10px;
}

.rec-priority {
 padding: 5px 12px;
 border-radius: 20px;
 font-size: 0.85rem;
 font-weight: bold;
}

.badge-critical {
 background: #ef4444;
 color: white;
}

.badge-high {
 background: #f59e0b;
 color: white;
}

.badge-medium {
 background: #3b82f6;
 color: white;
}

.badge-low {
 background: #10b981;
 color: white;
}

.rec-impact {
 color: #666;
 font-size: 0.9rem;
 font-style: italic;
}

.rec-title {
 font-size: 1.2rem;
 color: #333;
 margin-bottom: 10px;
}

.rec-description {
 color: #555;
 line-height: 1.6;
}

.features-list {
 display: flex;
 flex-direction: column;
 gap: 15px;
}

.feature-item {
 display: grid;
 grid-template-columns: 200px 1fr 80px;
 align-items: center;
 gap: 15px;
}

.feature-name {
 font-weight: 500;
 color: #333;
}

.feature-bar-container {
 background: #e0e7ff;
 height: 25px;
 border-radius: 12px;
 overflow: hidden;
}

.feature-bar {
 height: 100%;
 background: linear-gradient(90deg, #667eea, #764ba2);
 border-radius: 12px;
 transition: width 1s ease;
}

.feature-value {
 text-align: right;
 font-weight: bold;
 color: #667eea;
}

.action-buttons {
 display: flex;
 gap: 20px;
 justify-content: center;
 margin-top: 40px;
}

.btn {
 padding: 15px 30px;
 border-radius: 10px;
 text-decoration: none;
 font-weight: bold;
 display: inline-flex;
 align-items: center;
 gap: 10px;
 transition: transform 0.2s;
}

.btn:hover {
 transform: translateY(-2px);
}

.btn-primary {
 background: linear-gradient(135deg, #667eea, #764ba2);
 color: white;
}

.btn-secondary {
 background: #f3f4f6;
 color: #333;
}

@media (max-width: 768px) {
 .prediction-gauge {
 grid-template-columns: 1fr;
 }
 
 .metrics-grid {
 grid-template-columns: repeat(2, 1fr);
 }
 
 .feature-item {
 grid-template-columns: 1fr;
 gap: 5px;
 }
 
 .feature-bar-container {
 order: 3;
 }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
 // Animate circular progress
 const circularProgress = document.querySelector('.circular-progress');
 const percentage = circularProgress.dataset.percentage;
 circularProgress.style.setProperty('--percentage', percentage);
 
 // Animate feature bars
 setTimeout(() => {
 document.querySelectorAll('.feature-bar').forEach(bar => {
 bar.style.width = bar.style.width;
 });
 }, 100);
});
</script>
{% endblock %}
